<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>07-gradient_descent.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>Gradient Descent</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/index-DGasP9Lh.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/preload-helper-DItdS47A.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/clsx-D8GwTfvk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/cn-BKtXLv3a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/react-BGmjiNul.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/compiler-runtime-DeeZ7FnK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/jsx-runtime-ZmTK25f3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/badge-Ce8wRjuQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/hotkeys-BHHWjLlp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useEventListener-DIUKKfEy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/button-YC1gW_kJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/react-dom-C9fstfnp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/Combination-CMPwuAmi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/menu-items-CJhvWPOk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-uzvC4uAK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/createLucideIcon-CnW3RofX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/check-DdfN0k2d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/select-V5IdpNiR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/tooltip-CEc2ajau.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/use-toast-rmUWldD_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/_baseIsEqual-B9N9Mw_N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useEvent-DO6uJBas.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/invariant-CAG_dYON.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/_baseFor-Duhs3RiJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/merge-BBX6ug-N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/zod-Cg4WLWh2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/utils-DXvhzCGS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/constants-B6Cb__3x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/Deferred-CrO5-0RA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/config-CIrPQIbt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/uuid-DercMavo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/DeferredRequestRegistry-CO2AyNfd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/requests-BsVD4CdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/_hasUnicode-CWqKLxBC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/assertNever-CBU83Y6o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/_arrayReduce-TT0iOGKY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useLifecycle-D35CBukS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useNonce-_Aax6sXd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useTheme-DUdVAZI8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/once-Bul8mtFs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/capabilities-MM7JYRxj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/createReducer-Dnna-AUO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-DBwNzi3C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-ChS0Dc_R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-CtsanegT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-BIKFl48f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-B0VqT_4z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-TiFCI16_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-Cayq-K1c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-BYyu59D8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-Gqv0jSNr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/stex-CtmkcLz7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/toDate-CgbKQM5E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/cjs-CH5Rj0g8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/_baseProperty-NKyJO2oh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/now-6sUe0ZdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/debounce-B3mjKxHe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/toInteger-CDcO32Gx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/database-zap-B9y7063w.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/main-U5Goe76G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/cells-BpZ7g6ok.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/spinner-DaIKav-i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/chevron-right-DwagBitu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dropdown-menu-B-6unW-7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/kbd-C3JY7O_u.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/renderShortcut-DEwfrKeS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/multi-map-C8GlnP-4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/alert-BrGyZf9c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/alert-dialog-DwQffb13.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dialog-CxGKN4C_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-CdxIjAOP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/label-Be1daUcS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useDebounce-D5NcotGm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/textarea-DBO30D7K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/numbers-iQunIAXf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/SSRProvider-CEHRCdjA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/context-JwD-oSsl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useNumberFormatter-c6GXymzg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/usePress-Bup4EGrp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/input-pAun1m1X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/links-DHZUhGz-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/popover-Gz-GJzym.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/switch-8sn_4qbh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/table-C8uQmBAN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/mode-DX8pdI-l.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useAsyncData-C4XRy1BE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/errors-2SszdW9t.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/error-banner-DUzsIXtq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/copy-Bv2DBpIS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/memoize-BCOZVFBt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/get-6uJrSKbw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/capitalize-CmNnkG9y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/copy-CQ15EONK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/plus-BD5o34_i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/refresh-cw-CQd-1kjx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/trash-2-CyqGun26.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/triangle-alert-B65rDESJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/ai-model-dropdown-71lgLrLy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/defaultLocale-D_rSvXvJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/precisionRound-BMPhtTJQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/defaultLocale-C92Rrpmf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/vega-loader.browser-CRZ52CKf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/tooltip-BGrCWNss.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/ErrorBoundary-ChCiwl15.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useInstallPackage-Bdnnp5fe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/ImperativeModal-CUbWEBci.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/cell-link-Bw5bzt4a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/datasource-B0OJBphG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/state-BfXVTTtD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/MarimoErrorOutput-5rudBbo3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/copy-icon-BhONVREY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/html-to-image-DjukyIj4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/focus-D51fcwZX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/LazyAnyLanguageCodeMirror-yzHjsVJt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/chunk-5FQGJX7Z-CVUXBqX6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/katex-Dc8yG8NU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/markdown-renderer-DhMlG2dP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/command-DhzFN2CJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/download-BhCZMKuQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useRunCells-24p6hn99.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/purify.es-DNVQZNFu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/RenderHTML-CQZqVk1Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useIframeCapabilities-DuIDx9mD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/formats-W1SWxSE3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/en-US-pRRbZZHE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/isValid-DcYggVWP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dates-Dhn1r-h6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/maps-t9yNKYA8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/extends-B2LJnKU3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/emotion-is-prop-valid.esm-DD4AwVTU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useDateFormatter-CS4kbWl2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/range-D2UKkEg-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/table-DZR6ewbN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/JsonOutput-CknFTI_u.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/file-Cs1JbsV6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/play-BPIh-ZEU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/chat-components-CGlO4yUw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/isEmpty-CgX_-6Mt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/chat-display-B4mGvJ0X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useDeleteCell-5uYlTcQZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/icons-BhEXrzsb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/process-output-CagdHMzs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/blob-CuXvdYPX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/objectWithoutPropertiesLoose-DaPAPabU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/esm-DpMp6qko.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/add-cell-with-ai-pVFp5LZG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/chart-no-axes-column-W42b2ZIs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/square-function-CqXXKtIq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/spec-D1kBp3jX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/column-preview-CxMrs0B_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/toggle-jWKnIArU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/globals-DKH14XH0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/share-CbPtIlnM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/_baseSet-5Rdwpmr3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/react-resizable-panels.browser.esm-Ctj_10o2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/utilities.esm-CIPARd6-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/floating-outline-DcxjrFFt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useAddCell-BmeZUK02.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/eye-off-BhExYOph.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/readonly-python-code-DyP9LVLc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/file-video-camera-DW3v07j2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/types-DuQOSW7G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/refresh-ccw-DLEiQDS3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/form-DUA_Rz_a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/field-BEg1eC0P.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useBoolean-B1Xeh6vA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useDeepCompareMemoize-ZPd9PxYl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/types-CS34eOZi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/prop-types-BiQYf0aU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/es-D8BOePqo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/hasIn-CycJImp8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/_baseFlatten-CUZNxU8H.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/flatten-D-7VEN0q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/pick-B_6Qi5aM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/code-xml-XLwHyDBr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/download-B9SUL40m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/house-DhFkiXz7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/settings-DOXWMfVd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/square-C8Tw_XXG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/bundle.esm-2AjO7UK5.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/cells-jmgGt1lS.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/markdown-renderer-DdDKmWlR.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/JsonOutput-B7vuddcd.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/index-CikhHYAB.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
<style title='marimo-custom'>.marimo-output .markdown,
.markdown {
  font-size: 18px;
  line-height: 1.6;
}
</style></head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "07-gradient_descent.py",
            "mode": "read",
            "version": "0.19.7",
            "serverToken": "static",
            "config": {"ai": {"custom_providers": {}, "models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false, "signature_hint_on_typing": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 18, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": true, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_csv_encoding": "utf-8", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"app_title": "Gradient Descent", "auto_download": ["html"], "css_file": "style.css", "sql_output": "auto", "width": "columns"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "*gradient_descent"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "iLit", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZHCJ", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ROlb", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TqIu", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Vxnm", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "DnEU", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ulZA", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ecfG", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Pvdt", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZBYS", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aLJB", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nHfw", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "xXTn", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "AjVT", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "pHFh", "name": "_"}], "metadata": {"marimo_version": "0.19.7"}, "version": "1"},
            "session": {"cells": [{"code_hash": null, "console": [], "id": "Hbol", "outputs": []}, {"code_hash": null, "console": [], "id": "MJUe", "outputs": []}, {"code_hash": null, "console": [], "id": "vblA", "outputs": []}, {"code_hash": null, "console": [], "id": "bkHC", "outputs": []}, {"code_hash": null, "console": [], "id": "lEQa", "outputs": []}, {"code_hash": null, "console": [], "id": "PKri", "outputs": []}, {"code_hash": null, "console": [], "id": "Xref", "outputs": []}, {"code_hash": null, "console": [], "id": "SFPL", "outputs": []}, {"code_hash": null, "console": [], "id": "BYtC", "outputs": []}, {"code_hash": null, "console": [], "id": "RGSE", "outputs": []}, {"code_hash": null, "console": [], "id": "Kclp", "outputs": []}, {"code_hash": null, "console": [], "id": "emfo", "outputs": []}, {"code_hash": null, "console": [], "id": "Hstk", "outputs": []}, {"code_hash": null, "console": [], "id": "nWHF", "outputs": []}, {"code_hash": null, "console": [], "id": "iLit", "outputs": []}, {"code_hash": null, "console": [], "id": "ZHCJ", "outputs": []}, {"code_hash": null, "console": [], "id": "ROlb", "outputs": []}, {"code_hash": null, "console": [], "id": "qnkX", "outputs": []}, {"code_hash": null, "console": [], "id": "TqIu", "outputs": []}, {"code_hash": null, "console": [], "id": "Vxnm", "outputs": []}, {"code_hash": null, "console": [], "id": "DnEU", "outputs": []}, {"code_hash": null, "console": [], "id": "ulZA", "outputs": []}, {"code_hash": null, "console": [], "id": "ecfG", "outputs": []}, {"code_hash": null, "console": [], "id": "Pvdt", "outputs": []}, {"code_hash": null, "console": [], "id": "ZBYS", "outputs": []}, {"code_hash": null, "console": [], "id": "aLJB", "outputs": []}, {"code_hash": null, "console": [], "id": "nHfw", "outputs": []}, {"code_hash": null, "console": [], "id": "xXTn", "outputs": []}, {"code_hash": null, "console": [], "id": "AjVT", "outputs": []}, {"code_hash": null, "console": [], "id": "pHFh", "outputs": []}], "metadata": {"marimo_version": "0.19.7"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    %23%20%2F%2F%2F%20script%0A%23%20requires-python%20%3D%20%22%3E%3D3.14%22%0A%23%20dependencies%20%3D%20%5B%0A%23%20%20%20%20%20%22marimo%3E%3D0.19.6%22%2C%0A%23%20%20%20%20%20%22numpy%3D%3D2.4.2%22%2C%0A%23%20%20%20%20%20%22plotly%3D%3D6.5.2%22%2C%0A%23%20%20%20%20%20%22wigglystuff%3D%3D0.2.16%22%2C%0A%23%20%5D%0A%23%20%2F%2F%2F%0A%0Aimport%20marimo%0A%0A__generated_with%20%3D%20%220.19.7%22%0Aapp%20%3D%20marimo.App(%0A%20%20%20%20width%3D%22columns%22%2C%0A%20%20%20%20app_title%3D%22Gradient%20Descent%22%2C%0A%20%20%20%20css_file%3D%22style.css%22%2C%0A%20%20%20%20auto_download%3D%5B%22html%22%5D%2C%0A)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20return%20(mo%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Gradient%20descent%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20plotly.graph_objects%20as%20go%0A%20%20%20%20return%20go%2C%20np%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Gradient%20of%20a%20function%0A%0A%20%20%20%20The%20gradient%20%24%5Cnabla%20L(w)%24%20of%20a%20function%20%24L%24%20at%20a%20point%20%24w%24%20indicates%20the%20direction%20of%20steepest%20ascent.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np)%3A%0A%20%20%20%20%23%20L%2C%20grad_L%0A%0A%20%20%20%20def%20L(w0%2Cw1)%3A%0A%20%20%20%20%20%20%20%20return%202*w0**2%20%2B%20w1**2%0A%0A%20%20%20%20def%20grad_L(w0%2Cw1)%3A%0A%20%20%20%20%20%20%20%20return%20np.array(%5B4*w0%2C%202*w1%5D)%0A%20%20%20%20return%20L%2C%20grad_L%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%23%20w%20sliders%0A%0A%20%20%20%20w0_slider%20%3D%20mo.ui.slider(start%3D-5%2C%20stop%3D5%2C%20step%3D0.1%2Clabel%3Dr'%24w%5E0_1%24'%2Cvalue%3D1)%0A%20%20%20%20w1_slider%20%3D%20mo.ui.slider(start%3D-5%2C%20stop%3D5%2C%20step%3D0.1%2Clabel%3Dr'%24w%5E0_2%24'%2Cvalue%3D0)%0A%20%20%20%20return%20w0_slider%2C%20w1_slider%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20**Instructions**%3A%20Move%20the%20sliders%20to%20change%20the%20point%20where%20the%20gradient%20is%20computed.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(L%2C%20go%2C%20grad_L%2C%20mo%2C%20np%2C%20w0_slider%2C%20w1_slider)%3A%0A%20%20%20%20%23%20plots%0A%0A%20%20%20%20def%20plot_L_contour()%3A%0A%0A%20%20%20%20%20%20%20%20w0%20%3D%20np.zeros(2)%0A%20%20%20%20%20%20%20%20w0%5B0%5D%20%3D%20w0_slider.value%0A%20%20%20%20%20%20%20%20w0%5B1%5D%20%3D%20w1_slider.value%0A%20%20%20%20%20%20%20%20z0%20%3D%20L(w0%5B0%5D%2C%20w0%5B1%5D)%0A%0A%20%20%20%20%20%20%20%20tau%20%3D%200.15%0A%20%20%20%20%20%20%20%20w1%20%3D%20np.zeros_like(w0)%0A%20%20%20%20%20%20%20%20w1%20%3D%20w0%20%2B%20tau%20*%20grad_L(w0%5B0%5D%2C%20w0%5B1%5D)%0A%20%20%20%20%20%20%20%20z1%20%3D%20L(w1%5B0%5D%2C%20w1%5B1%5D)%0A%0A%20%20%20%20%20%20%20%20x%20%3D%20np.linspace(-10%2C%2010%2C%20100)%0A%20%20%20%20%20%20%20%20y%20%3D%20np.linspace(-10%2C%2010%2C%20100)%0A%20%20%20%20%20%20%20%20X%2C%20Y%20%3D%20np.meshgrid(x%2C%20y)%0A%20%20%20%20%20%20%20%20Z%20%3D%20L(X%2CY)%0A%0A%20%20%20%20%20%20%20%20fig%20%3D%20go.Figure()%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Contour(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dx%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3DZ%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20colorscale%3D%22Viridis%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20contours%3Ddict(coloring%3D%22heatmap%22%2C%20showlines%3DFalse)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showscale%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Scatter(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5Bw0%5B0%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3D%5Bw0%5B1%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D%22markers%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker%3Ddict(color%3D%22red%22%2C%20size%3D10)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%23%20add%20gradient%20vector%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Scatter(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5Bw0%5B0%5D%2C%20w1%5B0%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3D%5Bw0%5B1%5D%2C%20w1%5B1%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D%22lines%2Bmarkers%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(color%3D%22blue%22%2C%20width%3D2)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker%3Ddict(color%3D%22blue%22%2C%20size%3D5)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20fig.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D450%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D450%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3Ddict(l%3D10%2C%20r%3D10%2C%20t%3D10%2C%20b%3D10)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20xaxis%3Ddict(scaleanchor%3D%22y%22)%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20return%20fig%0A%0A%20%20%20%20def%20plot_L_3D()%3A%0A%0A%20%20%20%20%20%20%20%20w0%20%3D%20np.zeros_like(grad_L(0%2C0))%0A%20%20%20%20%20%20%20%20w0%5B0%5D%20%3D%20w0_slider.value%0A%20%20%20%20%20%20%20%20w0%5B1%5D%20%3D%20w1_slider.value%0A%20%20%20%20%20%20%20%20z0%20%3D%20L(w0%5B0%5D%2C%20w0%5B1%5D)%0A%0A%20%20%20%20%20%20%20%20%23%20surface%20grid%0A%20%20%20%20%20%20%20%20x%20%3D%20np.linspace(-10%2C%2010%2C%20100)%0A%20%20%20%20%20%20%20%20y%20%3D%20np.linspace(-10%2C%2010%2C%20100)%0A%20%20%20%20%20%20%20%20X%2C%20Y%20%3D%20np.meshgrid(x%2C%20y)%0A%20%20%20%20%20%20%20%20Z%20%3D%20L(X%2C%20Y)%0A%0A%20%20%20%20%20%20%20%20%23%20gradient%20at%20(x0%2C%20y0)%0A%20%20%20%20%20%20%20%20norm%20%3D%20np.linalg.norm(grad_L(w0%5B0%5D%2C%20w0%5B1%5D))%0A%20%20%20%20%20%20%20%20nu%20%3D%20grad_L(w0%5B0%5D%2C%20w0%5B1%5D)%20%2F%20norm%0A%0A%20%20%20%20%20%20%20%20%23%20line%20parameter%0A%20%20%20%20%20%20%20%20t%20%3D%20np.linspace(-5%2C%205%2C%20100)%0A%20%20%20%20%20%20%20%20w0_line%20%3D%20w0%5B0%5D%20%2B%20t%20*%20nu%5B0%5D%0A%20%20%20%20%20%20%20%20w1_line%20%3D%20w0%5B1%5D%20%2B%20t%20*%20nu%5B1%5D%0A%20%20%20%20%20%20%20%20z_line%20%3D%20L(w0_line%2C%20w1_line)%0A%0A%20%20%20%20%20%20%20%20fig%20%3D%20go.Figure()%0A%0A%20%20%20%20%20%20%20%20%23%20surface%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Surface(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dx%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3DZ%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20colorscale%3D%22Viridis%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showscale%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20opacity%3D0.75%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20point%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5Bw0%5B0%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3D%5Bw0%5B1%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3D%5Bz0%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D%22markers%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker%3Ddict(color%3D%22red%22%2C%20size%3D5)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20trace%20along%20gradient%20direction%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dw0_line%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dw1_line%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3Dz_line%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D%22lines%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(color%3D%22blue%22%2C%20width%3D5)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20fig.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D450%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D450%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3Ddict(l%3D10%2C%20r%3D10%2C%20t%3D10%2C%20b%3D10)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scene%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20aspectmode%3D%22cube%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dragmode%3D%22turntable%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20return%20fig%0A%0A%0A%20%20%20%20mo.hstack(%5Bmo.vstack(%5Bplot_L_contour()%2C%20w0_slider%2C%20w1_slider%5D%2C%20justify%3D'center'%2C%20align%3D'center')%2C%20plot_L_3D()%5D%2C%20justify%3D'center'%2C%20align%3D'center')%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20---%0A%0A%20%20%20%20%23%23%20Gradient%20descent%20algorithm%0A%0A%20%20%20%20The%20gradient%20descent%20algorithm%20starts%20from%20an%20initial%20guess.%20At%20each%20iteration%2C%20it%20computes%20the%20gradient%20of%20the%20function%20at%20the%20current%20point%20and%20updates%20the%20point%20by%20moving%20in%20the%20opposite%20direction%20of%20the%20gradient%2C%20scaled%20by%20a%20_learning%20rate_.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%23%20steps%20and%20learning%20rate%20sliders%0A%0A%20%20%20%20steps_slider%20%3D%20mo.ui.slider(start%3D1%2C%20stop%3D20%2C%20step%3D1%2C%20label%3Dr'Number%20of%20steps'%2C%20value%3D1)%0A%20%20%20%20learning_rate_slider%20%3D%20mo.ui.slider(start%3D0.001%2C%20stop%3D1.0%2C%20step%3D0.001%2C%20label%3Dr'Learning%20rate'%2C%20value%3D0.2)%0A%20%20%20%20return%20learning_rate_slider%2C%20steps_slider%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20In%202%20dimensions%2C%20if%20the%20objective%20is%20to%20minimize%20%24L(w)%24%2C%20the%20algorithm%20is%3A%0A%0A%20%20%20%20-%20Choose%20an%20initial%20guess%20%24w%5E0%24%0A%20%20%20%20-%20Choose%20a%20learning%20rate%20%24%5Ctau%24%0A%20%20%20%20-%20For%20each%20step%20%24k%20%5Cgeq%200%24%20do%3A%0A%20%20%20%20%20%20%20%20-%20Compute%20the%20gradient%20%24%5Cnabla%20L(w%5Ek)%24%0A%20%20%20%20%20%20%20%20-%20Update%20the%20point%20with%20the%20formula%3A%20%24w%5E%7Bk%2B1%7D%20%3D%20w%5Ek%20-%20%5Ctau%20%5Cnabla%20L%20(w%5Ek)%24%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.function%0A%23%20algorithm%0Adef%20gradient_descent(L%2Cgrad_L%2Cw0%2Clearning_rate%2Csteps)%3A%0A%0A%20%20%20%20w%20%3D%20w0%0A%20%20%20%20list_of_points%20%3D%20%5Bw%5D%0A%20%20%20%20for%20_%20in%20range(steps)%3A%0A%20%20%20%20%20%20%20%20w%20%3D%20w%20-%20learning_rate%20*%20grad_L(w%5B0%5D%2Cw%5B1%5D)%0A%20%20%20%20%20%20%20%20list_of_points.append(w)%0A%20%20%20%20return%20list_of_points%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20**Instructions**%3A%20Choose%20the%20coordinates%20of%20the%20initial%20point%2C%20the%20learning%20rate%2C%20and%20the%20number%20of%20steps%20with%20the%20sliders.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20L%2C%0A%20%20%20%20go%2C%0A%20%20%20%20grad_L%2C%0A%20%20%20%20learning_rate_slider%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20np%2C%0A%20%20%20%20steps_slider%2C%0A%20%20%20%20w0_slider%2C%0A%20%20%20%20w1_slider%2C%0A)%3A%0A%20%20%20%20%23%20plots%20for%20gradient%20descent%0A%0A%20%20%20%20def%20plot_gradient_descent_contour(L%2Cgrad_L)%3A%0A%0A%20%20%20%20%20%20%20%20fig%20%3D%20go.Figure()%0A%0A%20%20%20%20%20%20%20%20x%20%3D%20np.linspace(-10%2C%2010%2C%20100)%0A%20%20%20%20%20%20%20%20y%20%3D%20np.linspace(-10%2C%2010%2C%20100)%0A%20%20%20%20%20%20%20%20X%2C%20Y%20%3D%20np.meshgrid(x%2C%20y)%0A%20%20%20%20%20%20%20%20Z%20%3D%20L(X%2CY)%0A%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Contour(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dx%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3DZ%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20colorscale%3D%22Viridis%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20contours%3Ddict(coloring%3D%22heatmap%22%2C%20showlines%3DFalse)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showscale%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20fig.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D350%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D350%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3Ddict(l%3D10%2C%20r%3D10%2C%20t%3D10%2C%20b%3D10)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20xaxis%3Ddict(scaleanchor%3D%22y%22)%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20list_of_points%20%3D%20gradient_descent(L%3DL%2Cgrad_L%3Dgrad_L%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20w0%3Dnp.array(%5Bw0_slider.value%2C%20w1_slider.value%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20learning_rate%3Dlearning_rate_slider.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20steps%3Dsteps_slider.value%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20x_points%20%3D%20%5Bp%5B0%5D%20for%20p%20in%20list_of_points%5D%0A%20%20%20%20%20%20%20%20y_points%20%3D%20%5Bp%5B1%5D%20for%20p%20in%20list_of_points%5D%0A%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Scatter(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dx_points%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dy_points%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D%22lines%2Bmarkers%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(color%3D%22red%22%2C%20width%3D2)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker%3Ddict(color%3D%22red%22%2C%20size%3D5)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20return%20fig%0A%0A%20%20%20%20camera_state%20%3D%20%7B%22eye%22%3A%20dict(x%3D1.25%2C%20y%3D1.25%2C%20z%3D1.25)%7D%0A%0A%20%20%20%20def%20plot_gradient_descent_3D(L%2Cgrad_L)%3A%0A%0A%20%20%20%20%20%20%20%20global%20camera_state%0A%0A%0A%20%20%20%20%20%20%20%20fig%20%3D%20go.Figure()%0A%0A%20%20%20%20%20%20%20%20%23%20surface%20grid%0A%20%20%20%20%20%20%20%20x%20%3D%20np.linspace(-10%2C%2010%2C%20100)%0A%20%20%20%20%20%20%20%20y%20%3D%20np.linspace(-10%2C%2010%2C%20100)%0A%20%20%20%20%20%20%20%20X%2C%20Y%20%3D%20np.meshgrid(x%2C%20y)%0A%20%20%20%20%20%20%20%20Z%20%3D%20L(X%2C%20Y)%0A%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Surface(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dx%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3DZ%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20colorscale%3D%22Viridis%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showscale%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20opacity%3D0.75%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20fig.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D350%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D350%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3Ddict(l%3D10%2C%20r%3D10%2C%20t%3D10%2C%20b%3D10)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scene%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20aspectmode%3D%22cube%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dragmode%3D%22turntable%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20list_of_points%20%3D%20gradient_descent(L%3DL%2Cgrad_L%3Dgrad_L%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20w0%3Dnp.array(%5Bw0_slider.value%2C%20w1_slider.value%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20learning_rate%3Dlearning_rate_slider.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20steps%3Dsteps_slider.value%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20x_points%20%3D%20%5Bp%5B0%5D%20for%20p%20in%20list_of_points%5D%0A%20%20%20%20%20%20%20%20y_points%20%3D%20%5Bp%5B1%5D%20for%20p%20in%20list_of_points%5D%0A%20%20%20%20%20%20%20%20z_points%20%3D%20%5BL(p%5B0%5D%2C%20p%5B1%5D)%20for%20p%20in%20list_of_points%5D%0A%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Scatter3d(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dx_points%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dy_points%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3Dz_points%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D%22lines%2Bmarkers%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(color%3D%22red%22%2C%20width%3D5)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker%3Ddict(color%3D%22red%22%2C%20size%3D5)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20return%20fig%0A%0A%20%20%20%20def%20plot_cost_during_training(L%2Cgrad_L)%3A%0A%0A%20%20%20%20%20%20%20%20list_of_points%20%3D%20gradient_descent(L%3DL%2Cgrad_L%3Dgrad_L%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20w0%3Dnp.array(%5Bw0_slider.value%2C%20w1_slider.value%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20learning_rate%3Dlearning_rate_slider.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20steps%3Dsteps_slider.value%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20costs%20%3D%20%5BL(p%5B0%5D%2C%20p%5B1%5D)%20for%20p%20in%20list_of_points%5D%0A%20%20%20%20%20%20%20%20steps%20%3D%20list(range(len(costs)))%0A%0A%20%20%20%20%20%20%20%20fig%20%3D%20go.Figure()%0A%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Scatter(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dsteps%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dcosts%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D%22lines%2Bmarkers%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(color%3D%22red%22%2C%20width%3D2)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker%3Ddict(color%3D%22red%22%2C%20size%3D5)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20fig.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D350%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D350%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3Ddict(l%3D10%2C%20r%3D10%2C%20t%3D10%2C%20b%3D10)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20xaxis_title%3D%22Step%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20yaxis_title%3D%22Cost%20L(w)%22%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20return%20fig%0A%0A%20%20%20%20mo.hstack(%5Bmo.vstack(%5Bplot_gradient_descent_contour(L%2Cgrad_L)%2C%20w0_slider%2C%20w1_slider%2C%20learning_rate_slider%2C%20steps_slider%5D%2C%20justify%3D'center'%2C%20align%3D'center')%2C%20plot_gradient_descent_3D(L%2Cgrad_L)%2C%20plot_cost_during_training(L%2Cgrad_L)%5D%2C%20justify%3D'center'%2C%20align%3D'center')%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20plot_cost_during_training%2C%0A%20%20%20%20%20%20%20%20plot_gradient_descent_3D%2C%0A%20%20%20%20%20%20%20%20plot_gradient_descent_contour%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20---%0A%0A%20%20%20%20%23%23%20Quadratic%20losses%0A%0A%20%20%20%20Let%20us%20study%20quadratic%20losses%20of%20the%20form%0A%0A%20%20%20%20%24%24%0A%20%20%20%20L(w)%20%3D%20%5Cfrac%7B1%7D%7B2%7D%20w%5ET%20A%20w%0A%20%20%20%20%24%24%0A%0A%20%20%20%20where%20%24A%24%20is%20a%20symmetric%20positive%20definite%20matrix.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20np)%3A%0A%20%20%20%20%23%20theta%2C%20eig_1%2C%20eig_2%20sliders%0A%20%20%20%20theta_slider%20%3D%20mo.ui.slider(start%3D0%2C%20stop%3D2*np.pi%2C%20step%3D2*np.pi%2F100%2C%20label%3Dr'%24%5Ctheta%24'%2C%20value%3D0)%0A%20%20%20%20eig_1_slider%20%3D%20mo.ui.slider(start%3D0.1%2C%20stop%3D5.0%2C%20step%3D0.1%2C%20label%3Dr'%24%5Clambda_1%24'%2C%20value%3D1.0)%0A%20%20%20%20eig_2_slider%20%3D%20mo.ui.slider(start%3D0.1%2C%20stop%3D5.0%2C%20step%3D0.1%2C%20label%3Dr'%24%5Clambda_2%24'%2C%20value%3D1.0)%0A%20%20%20%20return%20eig_1_slider%2C%20eig_2_slider%2C%20theta_slider%0A%0A%0A%40app.cell%0Adef%20_(np%2C%20theta_slider)%3A%0A%20%20%20%20%23%20Q%0A%20%20%20%20theta%20%3D%20theta_slider.value%0A%20%20%20%20Q%20%3D%20np.array(%5B%5Bnp.cos(theta)%2C%20-np.sin(theta)%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bnp.sin(theta)%2C%20%20np.cos(theta)%5D%5D)%0A%20%20%20%20return%20(Q%2C)%0A%0A%0A%40app.cell%0Adef%20_(eig_1_slider%2C%20eig_2_slider%2C%20np)%3A%0A%20%20%20%20%23%20D%0A%20%20%20%20eig_1%20%3D%20eig_1_slider.value%0A%20%20%20%20eig_2%20%3D%20eig_2_slider.value%0A%20%20%20%20D%20%3D%20np.array(%5B%5Beig_1%2C%200%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B0%2C%20eig_2%5D%5D)%0A%20%20%20%20return%20D%2C%20eig_1%2C%20eig_2%0A%0A%0A%40app.cell%0Adef%20_(D%2C%20Q)%3A%0A%20%20%20%20%23%20A%0A%20%20%20%20A%20%3D%20Q%20%40%20D%20%40%20Q.T%0A%20%20%20%20return%20(A%2C)%0A%0A%0A%40app.cell%0Adef%20_(A)%3A%0A%20%20%20%20%23%20L_quadratic%0A%0A%20%20%20%20def%20L_quadratic(w0%2Cw1)%3A%0A%20%20%20%20%20%20%20%20return%200.5%20*%20(%20w0%20*%20(A%5B0%2C0%5D%20*%20w0%20%2B%20A%5B0%2C1%5D%20*%20w1)%20%2B%20w1%20*%20(A%5B1%2C0%5D%20*%20w0%20%2B%20A%5B1%2C1%5D%20*%20w1)%20)%0A%20%20%20%20return%20(L_quadratic%2C)%0A%0A%0A%40app.cell%0Adef%20_(L_quadratic%2C%20go%2C%20np)%3A%0A%20%20%20%20%23%20plot%20L_quadratic%0A%0A%20%20%20%20def%20plot_L_quadratic_contour()%3A%0A%0A%20%20%20%20%20%20%20%20x%20%3D%20np.linspace(-10%2C%2010%2C%20100)%0A%20%20%20%20%20%20%20%20y%20%3D%20np.linspace(-10%2C%2010%2C%20100)%0A%20%20%20%20%20%20%20%20X%2C%20Y%20%3D%20np.meshgrid(x%2C%20y)%0A%20%20%20%20%20%20%20%20Z%20%3D%20L_quadratic(X%2CY)%0A%0A%20%20%20%20%20%20%20%20fig%20%3D%20go.Figure()%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Contour(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dx%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3DZ%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20colorscale%3D%22Viridis%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20contours%3Ddict(coloring%3D%22heatmap%22%2C%20showlines%3DFalse)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showscale%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20fig.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D450%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D450%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3Ddict(l%3D10%2C%20r%3D10%2C%20t%3D10%2C%20b%3D10)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20xaxis%3Ddict(scaleanchor%3D%22y%22)%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20return%20fig%0A%0A%0A%20%20%20%20def%20plot_L_quadratic_3D()%3A%0A%0A%20%20%20%20%20%20%20%20%23%20surface%20grid%0A%20%20%20%20%20%20%20%20x%20%3D%20np.linspace(-10%2C%2010%2C%20100)%0A%20%20%20%20%20%20%20%20y%20%3D%20np.linspace(-10%2C%2010%2C%20100)%0A%20%20%20%20%20%20%20%20X%2C%20Y%20%3D%20np.meshgrid(x%2C%20y)%0A%20%20%20%20%20%20%20%20Z%20%3D%20L_quadratic(X%2C%20Y)%0A%0A%20%20%20%20%20%20%20%20fig%20%3D%20go.Figure()%0A%0A%20%20%20%20%20%20%20%20%23%20surface%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Surface(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dx%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dy%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20z%3DZ%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20colorscale%3D%22Viridis%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showscale%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20opacity%3D0.75%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20fig.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D450%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D450%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3Ddict(l%3D10%2C%20r%3D10%2C%20t%3D10%2C%20b%3D10)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20scene%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20aspectmode%3D%22cube%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dragmode%3D%22turntable%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zaxis%3Ddict(range%3D%5B0%2C%20400%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20return%20fig%0A%20%20%20%20return%20plot_L_quadratic_3D%2C%20plot_L_quadratic_contour%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20A%2C%0A%20%20%20%20D%2C%0A%20%20%20%20Q%2C%0A%20%20%20%20eig_1_slider%2C%0A%20%20%20%20eig_2_slider%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20plot_L_quadratic_3D%2C%0A%20%20%20%20plot_L_quadratic_contour%2C%0A%20%20%20%20theta_slider%2C%0A)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20theta_slider%2C%0A%20%20%20%20%20%20%20%20eig_1_slider%2C%0A%20%20%20%20%20%20%20%20eig_2_slider%2C%0A%20%20%20%20%20%20%20%20mo.md(fr%22%22%22%0A%0A%20%20%20%20%20%20%20%20%24%24%0A%20%20%20%20%20%20%20%20Q%20%3D%20%0A%20%20%20%20%20%20%20%20%5Cbegin%7B%7Bpmatrix%7D%7D%0A%20%20%20%20%20%20%20%20%5Ccos(%5Ctheta)%20%26%20-%5Csin(%5Ctheta)%20%5C%5C%0A%20%20%20%20%20%20%20%20%5Csin(%5Ctheta)%20%26%20%5Ccos(%5Ctheta)%0A%20%20%20%20%20%20%20%20%5Cend%7B%7Bpmatrix%7D%7D%0A%20%20%20%20%20%20%20%20%3D%20%5Cbegin%7B%7Bpmatrix%7D%7D%0A%20%20%20%20%20%20%20%20%7BQ%5B0%2C0%5D%3A.2f%7D%20%26%20%7BQ%5B0%2C1%5D%3A.2f%7D%20%5C%5C%0A%20%20%20%20%20%20%20%20%7BQ%5B1%2C0%5D%3A.2f%7D%20%26%20%7BQ%5B1%2C1%5D%3A.2f%7D%0A%20%20%20%20%20%20%20%20%5Cend%7B%7Bpmatrix%7D%7D%0A%20%20%20%20%20%20%20%20%24%24%0A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20)%2C%0A%0A%20%20%20%20%20%20%20%20mo.md(fr%22%22%22%0A%0A%20%20%20%20%20%20%20%20%24%24%0A%20%20%20%20%20%20%20%20D%20%3D%0A%20%20%20%20%20%20%20%20%5Cbegin%7B%7Bpmatrix%7D%7D%0A%20%20%20%20%20%20%20%20%5Clambda_1%20%26%200%20%5C%5C%0A%20%20%20%20%20%20%20%200%20%26%20%5Clambda_2%0A%20%20%20%20%20%20%20%20%5Cend%7B%7Bpmatrix%7D%7D%0A%20%20%20%20%20%20%20%20%3D%20%5Cbegin%7B%7Bpmatrix%7D%7D%0A%20%20%20%20%20%20%20%20%7BD%5B0%2C0%5D%3A.2f%7D%20%26%200%20%5C%5C%0A%20%20%20%20%20%20%20%200%20%26%20%7BD%5B1%2C1%5D%3A.2f%7D%0A%20%20%20%20%20%20%20%20%5Cend%7B%7Bpmatrix%7D%7D%0A%20%20%20%20%20%20%20%20%24%24%0A%20%20%20%20%20%20%20%20%22%22%22)%2C%0A%0A%20%20%20%20%20%20%20%20mo.md(fr%22%22%22%0A%0A%20%20%20%20%20%20%20%20%24%24%0A%20%20%20%20%20%20%20%20A%20%3D%20Q%20D%20Q%5ET%20%3D%0A%20%20%20%20%20%20%20%20%5Cbegin%7B%7Bpmatrix%7D%7D%0A%20%20%20%20%20%20%20%20%7BQ%5B0%2C0%5D%3A.2f%7D%20%26%20%7BQ%5B0%2C1%5D%3A.2f%7D%20%5C%5C%0A%20%20%20%20%20%20%20%20%7BQ%5B1%2C0%5D%3A.2f%7D%20%26%20%7BQ%5B1%2C1%5D%3A.2f%7D%0A%20%20%20%20%20%20%20%20%5Cend%7B%7Bpmatrix%7D%7D%20%0A%20%20%20%20%20%20%20%20%5Cbegin%7B%7Bpmatrix%7D%7D%0A%20%20%20%20%20%20%20%20%7BD%5B0%2C0%5D%3A.2f%7D%20%26%200%20%5C%5C%0A%20%20%20%20%20%20%20%200%20%26%20%7BD%5B1%2C1%5D%3A.2f%7D%0A%20%20%20%20%20%20%20%20%5Cend%7B%7Bpmatrix%7D%7D%0A%20%20%20%20%20%20%20%20%5Cbegin%7B%7Bpmatrix%7D%7D%0A%20%20%20%20%20%20%20%20%7BQ%5B0%2C0%5D%3A.2f%7D%20%26%20%7BQ%5B1%2C0%5D%3A.2f%7D%20%5C%5C%0A%20%20%20%20%20%20%20%20%7BQ%5B0%2C1%5D%3A.2f%7D%20%26%20%7BQ%5B1%2C1%5D%3A.2f%7D%0A%20%20%20%20%20%20%20%20%5Cend%7B%7Bpmatrix%7D%7D%0A%20%20%20%20%20%20%20%20%3D%20%0A%20%20%20%20%20%20%20%20%5Cbegin%7B%7Bpmatrix%7D%7D%0A%20%20%20%20%20%20%20%20%7BA%5B0%2C0%5D%3A.2f%7D%20%26%20%7BA%5B0%2C1%5D%3A.2f%7D%20%5C%5C%0A%20%20%20%20%20%20%20%20%7BA%5B1%2C0%5D%3A.2f%7D%20%26%20%7BA%5B1%2C1%5D%3A.2f%7D%0A%20%20%20%20%20%20%20%20%5Cend%7B%7Bpmatrix%7D%7D%0A%20%20%20%20%20%20%20%20%24%24%0A%0A%20%20%20%20%20%20%20%20%22%22%22)%2C%0A%0A%20%20%20%20%20%20%20%20mo.hstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20plot_L_quadratic_contour()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20plot_L_quadratic_3D()%0A%20%20%20%20%20%20%20%20%5D%2C%20justify%3D'center'%2C%20align%3D'center')%0A%0A%20%20%20%20%5D%2C%20justify%3D'center'%2C%20align%3D'start')%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20We%20can%20find%20the%20optimal%20learning%20rate%20that%20minimizes%20the%20convergence%20rate.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(eig_1%2C%20eig_1_slider%2C%20eig_2%2C%20eig_2_slider%2C%20go%2C%20mo%2C%20np)%3A%0A%20%20%20%20def%20plot_rate()%3A%0A%0A%20%20%20%20%20%20%20%20tau%20%3D%20np.linspace(0%2C%201%2C%20200)%0A%0A%20%20%20%20%20%20%20%20abs1%20%3D%20np.abs(1%20-%20tau%20*%20eig_1)%0A%20%20%20%20%20%20%20%20abs2%20%3D%20np.abs(1%20-%20tau%20*%20eig_2)%0A%0A%20%20%20%20%20%20%20%20rate%20%3D%20np.maximum(np.abs(1%20-%20tau%20*%20eig_1)%2C%20np.abs(1%20-%20tau%20*%20eig_2))%0A%0A%20%20%20%20%20%20%20%20fig%20%3D%20go.Figure()%0A%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Scatter(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dtau%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dabs1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D%22lines%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(color%3D%22red%22%2C%20width%3D1%2C%20dash%3D%22dash%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3Dr'%24%7C1%20-%20%5Ctau%20%5Clambda_1%7C%24'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Scatter(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dtau%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dabs2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D%22lines%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(color%3D%22green%22%2C%20width%3D1%2C%20dash%3D%22dash%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3Dr'%24%7C1%20-%20%5Ctau%20%5Clambda_2%7C%24'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Scatter(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dtau%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Drate%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D%22lines%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(color%3D%22blue%22%2C%20width%3D2)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20fig.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D650%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D400%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3Ddict(l%3D10%2C%20r%3D10%2C%20t%3D10%2C%20b%3D10)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20xaxis_title%3D%22Learning%20rate%20%24%5C%5Ctau%24%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20yaxis_title%3D%22Convergence%20rate%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20yaxis%3Ddict(range%3D%5B0%2C%202%5D)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20return%20fig%0A%0A%20%20%20%20def%20plot_optimal_rate()%3A%0A%0A%20%20%20%20%20%20%20%20condition_numbers%20%3D%20np.linspace(1%2C%2050%2C%20200)%0A%20%20%20%20%20%20%20%20optimal_rates%20%3D%20(condition_numbers%20-%201)%20%2F%20(condition_numbers%20%2B%201)%0A%0A%20%20%20%20%20%20%20%20tau_optimal%20%3D%202%20%2F%20(eig_1%20%2B%20eig_2)%0A%20%20%20%20%20%20%20%20rate_optimal%20%3D%20(eig_2%20-%20eig_1)%20%2F%20(eig_1%20%2B%20eig_2)%0A%0A%20%20%20%20%20%20%20%20fig%20%3D%20go.Figure()%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Scatter(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dcondition_numbers%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Doptimal_rates%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D%22lines%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(color%3D%22blue%22%2C%20width%3D2)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20showlegend%3DFalse%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20go.Scatter(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D%5Beig_2%20%2F%20eig_1%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3D%5Brate_optimal%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D%22markers%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker%3Ddict(color%3D%22red%22%2C%20size%3D10)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20fig.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D650%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D400%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3Ddict(l%3D10%2C%20r%3D10%2C%20t%3D10%2C%20b%3D10)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20xaxis_title%3D%22Condition%20number%20%24%5C%5Ckappa%20%3D%20%5C%5Cfrac%7B%5C%5Clambda_1%7D%7B%5C%5Clambda_2%7D%24%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20yaxis_title%3D%22Optimal%20convergence%20rate%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20xaxis%3Ddict(range%3D%5B1%2C%2050%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20yaxis%3Ddict(range%3D%5B0%2C%201%5D)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20return%20fig%0A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20eig_1_slider%2C%0A%20%20%20%20%20%20%20%20eig_2_slider%2C%0A%20%20%20%20%20%20%20%20mo.hstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20plot_rate()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20plot_optimal_rate()%0A%20%20%20%20%20%20%20%20%5D%2C%20justify%3D'center'%2C%20align%3D'center')%0A%20%20%20%20%5D%2C%20justify%3D'center'%2C%20align%3D'center')%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20---%0A%0A%20%20%20%20%23%20Issues%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%23%20Issue%201%3A%20suitable%20choice%20of%20the%20learning%20rate%0A%0A%20%20%20%20The%20learning%20rate%20is%20a%20hyperparameter%20that%20controls%20how%20much%20we%20are%20adjusting%20the%20weights%20of%20our%20network%20with%20respect%20the%20loss%20gradient.%20If%20the%20learning%20rate%20is%20too%20large%2C%20the%20algorithm%20can%20get%20stuck%20or%2C%20even%20worse%2C%20diverge.%20If%20the%20learning%20rate%20is%20too%20small%2C%20the%20algorithm%20will%20take%20too%20long%20to%20converge.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20L%2C%0A%20%20%20%20grad_L%2C%0A%20%20%20%20learning_rate_slider%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20plot_cost_during_training%2C%0A%20%20%20%20plot_gradient_descent_3D%2C%0A%20%20%20%20plot_gradient_descent_contour%2C%0A%20%20%20%20steps_slider%2C%0A%20%20%20%20w0_slider%2C%0A%20%20%20%20w1_slider%2C%0A)%3A%0A%20%20%20%20mo.hstack(%5Bmo.vstack(%5Bplot_gradient_descent_contour(L%2Cgrad_L)%2C%20w0_slider%2C%20w1_slider%2C%20learning_rate_slider%2C%20steps_slider%5D%2C%20justify%3D'center'%2C%20align%3D'center')%2C%20plot_gradient_descent_3D(L%2Cgrad_L)%2C%20plot_cost_during_training(L%2Cgrad_L)%5D%2C%20justify%3D'center'%2C%20align%3D'center')%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%23%20Issue%202%3A%20local%20minima%0A%0A%20%20%20%20Even%20when%20the%20learning%20rate%20is%20well%20chosen%2C%20the%20gradient%20descent%20algorithm%20can%20get%20stuck%20around%20a%20local%20minimum.%0A%0A%20%20%20%20Try%20the%20following%20example%20with%20a%20non-convex%20function.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np)%3A%0A%20%20%20%20%23%20non-convex%20L%20and%20grad_L%0A%0A%20%20%20%20def%20L_non_convex(w0%2Cw1)%3A%0A%20%20%20%20%20%20%20%20return%2080%20%2B%20w0**2%20-%2040*np.cos(2*np.pi*w0%2F5)%20%2B%20w1**2%20-%2040*np.cos(2*np.pi*w1%2F5)%0A%0A%20%20%20%20def%20grad_L_non_convex(w0%2Cw1)%3A%0A%20%20%20%20%20%20%20%20dL_dx%20%3D%202*w0%20%2B%2020*np.pi*np.sin(2*np.pi*w0)%0A%20%20%20%20%20%20%20%20dL_dy%20%3D%202*w1%20%2B%2020*np.pi*np.sin(2*np.pi*w1)%0A%20%20%20%20%20%20%20%20return%20np.array(%5BdL_dx%2C%20dL_dy%5D)%0A%20%20%20%20return%20L_non_convex%2C%20grad_L_non_convex%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20L_non_convex%2C%0A%20%20%20%20grad_L_non_convex%2C%0A%20%20%20%20learning_rate_slider%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20plot_cost_during_training%2C%0A%20%20%20%20plot_gradient_descent_3D%2C%0A%20%20%20%20plot_gradient_descent_contour%2C%0A%20%20%20%20steps_slider%2C%0A%20%20%20%20w0_slider%2C%0A%20%20%20%20w1_slider%2C%0A)%3A%0A%20%20%20%20%23%20plots%20for%20gradient%20descent%20on%20non-convex%20loss%0A%0A%20%20%20%20mo.hstack(%5Bmo.vstack(%5Bplot_gradient_descent_contour(L_non_convex%2Cgrad_L_non_convex)%2C%20w0_slider%2C%20w1_slider%2C%20learning_rate_slider%2C%20steps_slider%5D%2C%20justify%3D'center'%2C%20align%3D'center')%2C%20plot_gradient_descent_3D(L_non_convex%2Cgrad_L_non_convex)%2C%20plot_cost_during_training(L_non_convex%2Cgrad_L_non_convex)%5D%2C%20justify%3D'center'%2C%20align%3D'center')%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">d8f6399c5c39d86865a83b8745bd1a53</marimo-code-hash>
</body>
</html>
