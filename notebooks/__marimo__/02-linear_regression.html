<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>02-linear_regression.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>Linear Regression</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/index-DGasP9Lh.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/preload-helper-DItdS47A.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/clsx-D8GwTfvk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/cn-BKtXLv3a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/react-BGmjiNul.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/compiler-runtime-DeeZ7FnK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/jsx-runtime-ZmTK25f3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/badge-Ce8wRjuQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/hotkeys-BHHWjLlp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useEventListener-DIUKKfEy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/button-YC1gW_kJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/react-dom-C9fstfnp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/Combination-CMPwuAmi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/menu-items-CJhvWPOk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-uzvC4uAK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/createLucideIcon-CnW3RofX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/check-DdfN0k2d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/select-V5IdpNiR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/tooltip-CEc2ajau.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/use-toast-rmUWldD_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/_baseIsEqual-B9N9Mw_N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useEvent-DO6uJBas.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/invariant-CAG_dYON.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/_baseFor-Duhs3RiJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/merge-BBX6ug-N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/zod-Cg4WLWh2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/utils-DXvhzCGS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/constants-B6Cb__3x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/Deferred-CrO5-0RA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/config-CIrPQIbt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/uuid-DercMavo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/DeferredRequestRegistry-CO2AyNfd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/requests-BsVD4CdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/_hasUnicode-CWqKLxBC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/assertNever-CBU83Y6o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/_arrayReduce-TT0iOGKY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useLifecycle-D35CBukS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useNonce-_Aax6sXd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useTheme-DUdVAZI8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/once-Bul8mtFs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/capabilities-MM7JYRxj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/createReducer-Dnna-AUO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-DBwNzi3C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-ChS0Dc_R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-CtsanegT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-BIKFl48f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-B0VqT_4z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-TiFCI16_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-Cayq-K1c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-BYyu59D8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-Gqv0jSNr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/stex-CtmkcLz7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/toDate-CgbKQM5E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/cjs-CH5Rj0g8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/_baseProperty-NKyJO2oh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/now-6sUe0ZdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/debounce-B3mjKxHe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/toInteger-CDcO32Gx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/database-zap-B9y7063w.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/main-U5Goe76G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/cells-BpZ7g6ok.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/spinner-DaIKav-i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/chevron-right-DwagBitu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dropdown-menu-B-6unW-7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/kbd-C3JY7O_u.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/renderShortcut-DEwfrKeS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/multi-map-C8GlnP-4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/alert-BrGyZf9c.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/alert-dialog-DwQffb13.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dialog-CxGKN4C_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dist-CdxIjAOP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/label-Be1daUcS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useDebounce-D5NcotGm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/textarea-DBO30D7K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/numbers-iQunIAXf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/SSRProvider-CEHRCdjA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/context-JwD-oSsl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useNumberFormatter-c6GXymzg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/usePress-Bup4EGrp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/input-pAun1m1X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/links-DHZUhGz-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/popover-Gz-GJzym.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/switch-8sn_4qbh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/table-C8uQmBAN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/mode-DX8pdI-l.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useAsyncData-C4XRy1BE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/errors-2SszdW9t.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/error-banner-DUzsIXtq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/copy-Bv2DBpIS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/memoize-BCOZVFBt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/get-6uJrSKbw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/capitalize-CmNnkG9y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/copy-CQ15EONK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/plus-BD5o34_i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/refresh-cw-CQd-1kjx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/trash-2-CyqGun26.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/triangle-alert-B65rDESJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/ai-model-dropdown-71lgLrLy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/defaultLocale-D_rSvXvJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/precisionRound-BMPhtTJQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/defaultLocale-C92Rrpmf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/vega-loader.browser-CRZ52CKf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/tooltip-BGrCWNss.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/ErrorBoundary-ChCiwl15.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useInstallPackage-Bdnnp5fe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/ImperativeModal-CUbWEBci.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/cell-link-Bw5bzt4a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/datasource-B0OJBphG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/state-BfXVTTtD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/MarimoErrorOutput-5rudBbo3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/copy-icon-BhONVREY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/html-to-image-DjukyIj4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/focus-D51fcwZX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/LazyAnyLanguageCodeMirror-yzHjsVJt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/chunk-5FQGJX7Z-CVUXBqX6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/katex-Dc8yG8NU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/markdown-renderer-DhMlG2dP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/command-DhzFN2CJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/download-BhCZMKuQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useRunCells-24p6hn99.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/purify.es-DNVQZNFu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/RenderHTML-CQZqVk1Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useIframeCapabilities-DuIDx9mD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/formats-W1SWxSE3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/en-US-pRRbZZHE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/isValid-DcYggVWP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/dates-Dhn1r-h6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/maps-t9yNKYA8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/extends-B2LJnKU3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/emotion-is-prop-valid.esm-DD4AwVTU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useDateFormatter-CS4kbWl2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/range-D2UKkEg-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/table-DZR6ewbN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/JsonOutput-CknFTI_u.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/file-Cs1JbsV6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/play-BPIh-ZEU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/chat-components-CGlO4yUw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/isEmpty-CgX_-6Mt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/chat-display-B4mGvJ0X.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useDeleteCell-5uYlTcQZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/icons-BhEXrzsb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/process-output-CagdHMzs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/blob-CuXvdYPX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/objectWithoutPropertiesLoose-DaPAPabU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/esm-DpMp6qko.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/add-cell-with-ai-pVFp5LZG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/chart-no-axes-column-W42b2ZIs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/square-function-CqXXKtIq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/spec-D1kBp3jX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/column-preview-CxMrs0B_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/toggle-jWKnIArU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/globals-DKH14XH0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/share-CbPtIlnM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/_baseSet-5Rdwpmr3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/react-resizable-panels.browser.esm-Ctj_10o2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/utilities.esm-CIPARd6-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/floating-outline-DcxjrFFt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useAddCell-BmeZUK02.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/eye-off-BhExYOph.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/readonly-python-code-DyP9LVLc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/file-video-camera-DW3v07j2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/types-DuQOSW7G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/refresh-ccw-DLEiQDS3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/form-DUA_Rz_a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/field-BEg1eC0P.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useBoolean-B1Xeh6vA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/useDeepCompareMemoize-ZPd9PxYl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/types-CS34eOZi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/prop-types-BiQYf0aU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/es-D8BOePqo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/hasIn-CycJImp8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/_baseFlatten-CUZNxU8H.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/flatten-D-7VEN0q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/pick-B_6Qi5aM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/code-xml-XLwHyDBr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/download-B9SUL40m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/house-DhFkiXz7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/settings-DOXWMfVd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/square-C8Tw_XXG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/bundle.esm-2AjO7UK5.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/cells-jmgGt1lS.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/markdown-renderer-DdDKmWlR.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/JsonOutput-B7vuddcd.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.7/dist/assets/index-CikhHYAB.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
<style title='marimo-custom'>.marimo-output .markdown,
.markdown {
  font-size: 18px;
  line-height: 1.6;
}
</style></head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "02-linear_regression.py",
            "mode": "read",
            "version": "0.19.7",
            "serverToken": "static",
            "config": {"ai": {"custom_providers": {}, "models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false, "signature_hint_on_typing": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 18, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": true, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_csv_encoding": "utf-8", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"app_title": "Linear Regression", "auto_download": ["html"], "css_file": "style.css", "sql_output": "auto", "width": "columns"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo", "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "config": {"column": 0, "disabled": false, "hide_code": false}, "id": "evZO", "name": "_"}, {"code": "mo.md(r\"\"\"\n# Linear regression\n\nWe recall one of the most basic models in machine learning: linear regression. We apply it to the problem of predicting the price of a house.\n\"\"\")", "code_hash": "2231e2e5cba36411264338c1c80cf75c", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "vrVV", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Dataset\n\nWe use the dataset available on [Kaggle](https://www.kaggle.com/datasets/kirbysasuke/house-price-prediction-simplified-for-regression). Its format is a CSV file. We load it as a `DataFrame` using the `pandas` library and we explore it.\n\"\"\")", "code_hash": "cefd545f5f49d0b4083012611a64e535", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "FWKX", "name": "_"}, {"code": "import pandas as pd", "code_hash": "c1b7b1d18b5ff786fb8c4d2ef4e0138a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "OFxy", "name": "_"}, {"code": "from pathlib import Path\n\nBASE_DIR = Path(__file__).resolve().parent.parent\n\ndata_path = BASE_DIR / 'datasets' / 'Real_Estate.csv'\ndata = pd.read_csv(data_path)", "code_hash": "92c9c2a51bb47d724bb49978e12ca0f4", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ORIE", "name": "_"}, {"code": "data", "code_hash": "8d777f385d3dfec8815d20f7496026dc", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "OjGc", "name": "_"}, {"code": "mo.md(r\"\"\"\nWe have a dataset with 414 observations and 7 columns. We will do a simple linear regression using the following features:\n- `House age` -\u003E $X_0$\n- `Distance to the nearest MRT station` -\u003E $X_1$\n- `Number of convenience stores` -\u003E $X_2$\n- `Latitude` -\u003E $X_3$\n- `Longitude` -\u003E $X_4$\n\ntrying to predict the\n- `House price of unit area` -\u003E $Y$\n\"\"\")", "code_hash": "dc0c061609838de860920c559f976a12", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "tHDH", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Recalling the linear regression model\n\nWe want to predict the `House price of unit area` based on the other features with a linear model, _i.e._, a prediction based on the ansatz\n\n$$\nY \\approx w_0 X_0 + w_1 X_1 + w_2 X_2 + w_3 X_3 + w_4 X_4 + b.\n$$\n\nThe objective is to find \"good\" values for the weights $w_0, w_1, w_2, w_3, w_4$ and the bias $b$, exploiting the available data.\n\nThe linear regression model can be written compactly as\n\n$$\nf(X;w,b) = Xw + b,\n$$\n\nwhere $X = (X_0, X_1, \\dots, X_{M-1}) \\in \\mathbb{R}^{1 \\times M}$ is the random feature vector, $w \\in \\mathbb{R}^{M\\times 1}$ is the weights vector, and $b \\in \\mathbb{R}$ is the bias. The objective is to find the weights $w$ and the bias $b$ that minimize the mean squared error (MSE) between the predictions and the real target, _i.e._,\n\n$$\n\\min_{\\substack{w \\in \\mathbb{R}^{M \\times 1} \\\\ \\ b \\in \\mathbb{R}}} L(w,b;\\{(x_i,y_i)\\}_{i=0,\\dots,N-1})\\, , \\  \\quad \\text{where } L(w,b;\\{(x_i,y_i)\\}_{i=0,\\dots,N-1}) = \\frac{1}{N} \\sum_{i=0}^{N-1} (x_i w + b - y_i)^2.\n$$\n\nThe minimum can be found explicitly by solving the _normal equation_\n\n$$\nA \\begin{pmatrix} w \\\\ b \\end{pmatrix} = c ,\n$$\n\nwhere\n\n$$\nA = \\frac{1}{N} \\tilde x^\\top \\tilde x \\in \\mathbb{R}^{(M+1) \\times (M+1)} , \\quad c = \\frac{1}{N} \\tilde x^\\top y , \\quad \\tilde x = \\begin{pmatrix} x \u0026 1 \\end{pmatrix} \\in \\mathbb{R}^{N \\times (M+1)} .\n$$\n\"\"\")", "code_hash": "b1f40e5298389b036ba3c5f752ab4bb2", "config": {"column": 1, "disabled": false, "hide_code": true}, "id": "jpfB", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ckue", "name": "_"}, {"code": "import torch", "code_hash": "e2ddceb8064dfb2235ad898d34eee19a", "config": {"column": 2, "disabled": false, "hide_code": false}, "id": "HzpD", "name": "_"}, {"code": "features = ['House age', 'Distance to the nearest MRT station', 'Number of convenience stores', 'Latitude', 'Longitude']\ndata[features] ", "code_hash": "fe4c81c48465a27ec678764a0c711ac4", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "uWJa", "name": "_"}, {"code": "n_training_samples = int(0.8 * len(data))", "code_hash": "b5896d231f4d90d13f5fa1f46746268d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "fdjT", "name": "_"}, {"code": "n_training_samples", "code_hash": "11675f797af24f826007240f2e5bd2a7", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "EJJg", "name": "_"}, {"code": "torch.manual_seed(42)\npermuted_indices = torch.randperm(len(data))\ntraining_indices = permuted_indices[:n_training_samples]\ntest_indices = permuted_indices[n_training_samples:]", "code_hash": "3ae458f125525438c45a2c9d09a241f7", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "VICA", "name": "_"}, {"code": "x_train = torch.tensor(data[features].iloc[training_indices].values, dtype=torch.float32)\nx_test = torch.tensor(data[features].iloc[test_indices].values, dtype=torch.float32)\ny_train = torch.tensor(data['House price of unit area'].iloc[training_indices].values, dtype=torch.float32).view(n_training_samples, 1)\ny_test = torch.tensor(data['House price of unit area'].iloc[test_indices].values, dtype=torch.float32).view(-1, 1)", "code_hash": "cfb3e003bb506ea910fc2ab2ea192fd3", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "LBCi", "name": "_"}, {"code": "x_train.shape", "code_hash": "bbffb686195026e2ecfa63ce3827986c", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Qdux", "name": "_"}, {"code": "y_train.shape", "code_hash": "5952c152bb82b5b42d1dee25fa30551f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PHlD", "name": "_"}, {"code": "x_tilde = torch.cat((x_train, torch.ones(n_training_samples,1)), dim=1)", "code_hash": "a9589686ee969934069b7409f28551fe", "config": {"column": 3, "disabled": false, "hide_code": false}, "id": "TdAs", "name": "_"}, {"code": "x_tilde.t()", "code_hash": "f0b0fa205c9c5d880ea906dda1f2f04a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PkCp", "name": "_"}, {"code": "A = 1 / n_training_samples * x_tilde.t() @ x_tilde", "code_hash": "c90c3e5204a61773f24a3c90110826bc", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "dGyc", "name": "_"}, {"code": "A.shape", "code_hash": "fdaf77318730f67db39edb6f01acc161", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "gjXN", "name": "_"}, {"code": "c = 1 / n_training_samples * x_tilde.t() @ y_train", "code_hash": "822dff8a23f338e238896a50151b43d5", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Lyos", "name": "_"}, {"code": "c.shape", "code_hash": "dea274997248f06934893ad554af2195", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZPCK", "name": "_"}, {"code": "solution = torch.linalg.solve(A, c)", "code_hash": "e87eb88e7375d4292d1c420e1f213bdb", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Jvnp", "name": "_"}, {"code": "w = solution[:5]\nb = solution[5]", "code_hash": "f25d956f78d3343d9d543d833b4f9406", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lhDx", "name": "_"}, {"code": "w.shape", "code_hash": "a36d6ffdd189139bf652b368490f83d8", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "eFqC", "name": "_"}, {"code": "b", "code_hash": "92eb5ffee6ae2fec3ad71c777531578f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "zTee", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "xysv", "name": "_"}, {"code": "R2_train = 1 - ( ( y_train - ( x_train @ w + b ) )**2 ).sum() / ( ( y_train - y_train.mean() )**2 ).sum()\nprint(R2_train)", "code_hash": "d9acdfd64fd5c663a7f1297738f46d0d", "config": {"column": 4, "disabled": false, "hide_code": false}, "id": "WGep", "name": "_"}, {"code": "R2_test = 1 - ( ( y_test - ( x_test @ w + b ) )**2 ).sum() / ( ( y_test - y_test.mean() )**2 ).sum()\nprint(R2_test)", "code_hash": "62d104e1c23bc9a3bdd0ef2650363242", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MMvh", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "KkLM", "name": "_"}], "metadata": {"marimo_version": "0.19.7"}, "version": "1"},
            "session": {"cells": [{"code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "console": [], "id": "evZO", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "2231e2e5cba36411264338c1c80cf75c", "console": [], "id": "vrVV", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"linear-regression\"\u003ELinear regression\u003C/h1\u003E\n\u003Cspan class=\"paragraph\"\u003EWe recall one of the most basic models in machine learning: linear regression. We apply it to the problem of predicting the price of a house.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "cefd545f5f49d0b4083012611a64e535", "console": [], "id": "FWKX", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"dataset\"\u003EDataset\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EWe use the dataset available on \u003Ca href=\"https://www.kaggle.com/datasets/kirbysasuke/house-price-prediction-simplified-for-regression\" rel=\"noopener noreferrer\" target=\"_blank\"\u003EKaggle\u003C/a\u003E. Its format is a CSV file. We load it as a \u003Ccode\u003EDataFrame\u003C/code\u003E using the \u003Ccode\u003Epandas\u003C/code\u003E library and we explore it.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "c1b7b1d18b5ff786fb8c4d2ef4e0138a", "console": [], "id": "OFxy", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "92c9c2a51bb47d724bb49978e12ca0f4", "console": [], "id": "ORIE", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "8d777f385d3dfec8815d20f7496026dc", "console": [], "id": "OjGc", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='OjGc-0' random-id='62102a01-8b45-e542-8917-2c672923577f'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;Transaction date\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2012-09-02 16:42:30.519336\u0026#92;\u0026quot;,\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:13.3,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:4082.015,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:8,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:25.0070586835347,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.561694217708,\u0026#92;\u0026quot;House price of unit area\u0026#92;\u0026quot;:6.48867313986559},{\u0026#92;\u0026quot;Transaction date\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2012-09-04 22:52:29.919544\u0026#92;\u0026quot;,\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:35.5,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:274.0144,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:2,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:25.0121482576502,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.546989844571,\u0026#92;\u0026quot;House price of unit area\u0026#92;\u0026quot;:24.9707246507222},{\u0026#92;\u0026quot;Transaction date\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2012-09-05 01:10:52.349449\u0026#92;\u0026quot;,\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:1.1,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:1978.671,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:10,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:25.0038498628365,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.528336472882,\u0026#92;\u0026quot;House price of unit area\u0026#92;\u0026quot;:26.6942667687913},{\u0026#92;\u0026quot;Transaction date\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2012-09-05 13:26:01.189083\u0026#92;\u0026quot;,\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:22.2,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:1055.067,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:5,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:24.9628870027666,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.48217837539,\u0026#92;\u0026quot;House price of unit area\u0026#92;\u0026quot;:38.091638492386},{\u0026#92;\u0026quot;Transaction date\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2012-09-06 08:29:47.910523\u0026#92;\u0026quot;,\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:8.5,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:967.4,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:25.0110368202032,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.479946198787,\u0026#92;\u0026quot;House price of unit area\u0026#92;\u0026quot;:21.6547095988987},{\u0026#92;\u0026quot;Transaction date\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2012-09-06 14:18:34.142030\u0026#92;\u0026quot;,\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:13.3,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:279.1726,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:2,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:24.9949935390321,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.543823378185,\u0026#92;\u0026quot;House price of unit area\u0026#92;\u0026quot;:36.9723757859779},{\u0026#92;\u0026quot;Transaction date\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2012-09-06 15:07:23.396013\u0026#92;\u0026quot;,\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:38.5,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:377.7956,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:3,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:25.0098948639372,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.558955290137,\u0026#92;\u0026quot;House price of unit area\u0026#92;\u0026quot;:27.6373820952976},{\u0026#92;\u0026quot;Transaction date\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2012-09-07 07:57:25.291322\u0026#92;\u0026quot;,\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:15.2,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:552.4371,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:5,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:24.9971093438101,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.544377460949,\u0026#92;\u0026quot;House price of unit area\u0026#92;\u0026quot;:44.116585007819},{\u0026#92;\u0026quot;Transaction date\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2012-09-07 10:06:48.384148\u0026#92;\u0026quot;,\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:24.0,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:617.4424,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:3,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:24.9876216824302,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.527841153188,\u0026#92;\u0026quot;House price of unit area\u0026#92;\u0026quot;:49.0712467463324},{\u0026#92;\u0026quot;Transaction date\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2012-09-07 13:21:33.254701\u0026#92;\u0026quot;,\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:13.0,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:323.655,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:8,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:24.9786630373686,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.483457129929,\u0026#92;\u0026quot;House price of unit area\u0026#92;\u0026quot;:43.1143527472704}]\u0026quot;' data-total-rows='414' data-total-columns='7' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='10' data-field-types='[[\u0026quot;Transaction date\u0026quot;,[\u0026quot;unknown\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;House age\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;Distance to the nearest MRT station\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;Number of convenience stores\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]],[\u0026quot;Latitude\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;Longitude\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;House price of unit area\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "dc0c061609838de860920c559f976a12", "console": [], "id": "tHDH", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EWe have a dataset with 414 observations and 7 columns. We will do a simple linear regression using the following features:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003EHouse age\u003C/code\u003E -\u0026gt; \u003Cmarimo-tex class=\"arithmatex\"\u003E||(X_0||)\u003C/marimo-tex\u003E\u003C/li\u003E\n\u003Cli\u003E\u003Ccode\u003EDistance to the nearest MRT station\u003C/code\u003E -\u0026gt; \u003Cmarimo-tex class=\"arithmatex\"\u003E||(X_1||)\u003C/marimo-tex\u003E\u003C/li\u003E\n\u003Cli\u003E\u003Ccode\u003ENumber of convenience stores\u003C/code\u003E -\u0026gt; \u003Cmarimo-tex class=\"arithmatex\"\u003E||(X_2||)\u003C/marimo-tex\u003E\u003C/li\u003E\n\u003Cli\u003E\u003Ccode\u003ELatitude\u003C/code\u003E -\u0026gt; \u003Cmarimo-tex class=\"arithmatex\"\u003E||(X_3||)\u003C/marimo-tex\u003E\u003C/li\u003E\n\u003Cli\u003E\u003Ccode\u003ELongitude\u003C/code\u003E -\u0026gt; \u003Cmarimo-tex class=\"arithmatex\"\u003E||(X_4||)\u003C/marimo-tex\u003E\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003Etrying to predict the\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003EHouse price of unit area\u003C/code\u003E -\u0026gt; \u003Cmarimo-tex class=\"arithmatex\"\u003E||(Y||)\u003C/marimo-tex\u003E\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "b1f40e5298389b036ba3c5f752ab4bb2", "console": [], "id": "jpfB", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"recalling-the-linear-regression-model\"\u003ERecalling the linear regression model\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EWe want to predict the \u003Ccode\u003EHouse price of unit area\u003C/code\u003E based on the other features with a linear model, \u003Cem\u003Ei.e.\u003C/em\u003E, a prediction based on the ansatz\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\nY \\approx w_0 X_0 + w_1 X_1 + w_2 X_2 + w_3 X_3 + w_4 X_4 + b.\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EThe objective is to find \"good\" values for the weights \u003Cmarimo-tex class=\"arithmatex\"\u003E||(w_0, w_1, w_2, w_3, w_4||)\u003C/marimo-tex\u003E and the bias \u003Cmarimo-tex class=\"arithmatex\"\u003E||(b||)\u003C/marimo-tex\u003E, exploiting the available data.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThe linear regression model can be written compactly as\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\nf(X;w,b) = Xw + b,\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere \u003Cmarimo-tex class=\"arithmatex\"\u003E||(X = (X_0, X_1, \\dots, X_{M-1}) \\in \\mathbb{R}^{1 \\times M}||)\u003C/marimo-tex\u003E is the random feature vector, \u003Cmarimo-tex class=\"arithmatex\"\u003E||(w \\in \\mathbb{R}^{M\\times 1}||)\u003C/marimo-tex\u003E is the weights vector, and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(b \\in \\mathbb{R}||)\u003C/marimo-tex\u003E is the bias. The objective is to find the weights \u003Cmarimo-tex class=\"arithmatex\"\u003E||(w||)\u003C/marimo-tex\u003E and the bias \u003Cmarimo-tex class=\"arithmatex\"\u003E||(b||)\u003C/marimo-tex\u003E that minimize the mean squared error (MSE) between the predictions and the real target, \u003Cem\u003Ei.e.\u003C/em\u003E,\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\min_{\\substack{w \\in \\mathbb{R}^{M \\times 1} \\\\ \\ b \\in \\mathbb{R}}} L(w,b;\\{(x_i,y_i)\\}_{i=0,\\dots,N-1})\\, , \\  \\quad \\text{where } L(w,b;\\{(x_i,y_i)\\}_{i=0,\\dots,N-1}) = \\frac{1}{N} \\sum_{i=0}^{N-1} (x_i w + b - y_i)^2.\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EThe minimum can be found explicitly by solving the \u003Cem\u003Enormal equation\u003C/em\u003E\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\nA \\begin{pmatrix} w \\\\ b \\end{pmatrix} = c ,\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\nA = \\frac{1}{N} \\tilde x^\\top \\tilde x \\in \\mathbb{R}^{(M+1) \\times (M+1)} , \\quad c = \\frac{1}{N} \\tilde x^\\top y , \\quad \\tilde x = \\begin{pmatrix} x \u0026amp; 1 \\end{pmatrix} \\in \\mathbb{R}^{N \\times (M+1)} .\n||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": null, "console": [], "id": "ckue", "outputs": []}, {"code_hash": "e2ddceb8064dfb2235ad898d34eee19a", "console": [], "id": "HzpD", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "fe4c81c48465a27ec678764a0c711ac4", "console": [], "id": "uWJa", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='uWJa-0' random-id='d2716ada-f778-c280-4458-72563f17a15d'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:13.3,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:4082.015,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:8,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:25.0070586835347,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.561694217708},{\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:35.5,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:274.0144,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:2,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:25.0121482576502,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.546989844571},{\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:1.1,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:1978.671,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:10,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:25.0038498628365,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.528336472882},{\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:22.2,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:1055.067,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:5,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:24.9628870027666,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.48217837539},{\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:8.5,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:967.4,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:25.0110368202032,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.479946198787},{\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:13.3,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:279.1726,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:2,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:24.9949935390321,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.543823378185},{\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:38.5,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:377.7956,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:3,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:25.0098948639372,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.558955290137},{\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:15.2,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:552.4371,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:5,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:24.9971093438101,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.544377460949},{\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:24.0,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:617.4424,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:3,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:24.9876216824302,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.527841153188},{\u0026#92;\u0026quot;House age\u0026#92;\u0026quot;:13.0,\u0026#92;\u0026quot;Distance to the nearest MRT station\u0026#92;\u0026quot;:323.655,\u0026#92;\u0026quot;Number of convenience stores\u0026#92;\u0026quot;:8,\u0026#92;\u0026quot;Latitude\u0026#92;\u0026quot;:24.9786630373686,\u0026#92;\u0026quot;Longitude\u0026#92;\u0026quot;:121.483457129929}]\u0026quot;' data-total-rows='414' data-total-columns='5' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='10' data-field-types='[[\u0026quot;House age\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;Distance to the nearest MRT station\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;Number of convenience stores\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]],[\u0026quot;Latitude\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;Longitude\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "b5896d231f4d90d13f5fa1f46746268d", "console": [], "id": "fdjT", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "11675f797af24f826007240f2e5bd2a7", "console": [], "id": "EJJg", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003E331\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "3ae458f125525438c45a2c9d09a241f7", "console": [], "id": "VICA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "cfb3e003bb506ea910fc2ab2ea192fd3", "console": [], "id": "LBCi", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "bbffb686195026e2ecfa63ce3827986c", "console": [], "id": "Qdux", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003Etorch.Size([331, 5])\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "5952c152bb82b5b42d1dee25fa30551f", "console": [], "id": "PHlD", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003Etorch.Size([331, 1])\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "a9589686ee969934069b7409f28551fe", "console": [], "id": "TdAs", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "f0b0fa205c9c5d880ea906dda1f2f04a", "console": [], "id": "PkCp", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003Etensor([[2.4200e+01, 5.6000e+00, 1.6900e+01,  ..., 3.2100e+01, 5.6000e+00,\n         3.1000e+00],\n        [1.2647e+03, 3.8328e+02, 1.4558e+03,  ..., 1.5093e+02, 2.7074e+03,\n         4.5164e+02],\n        [8.0000e+00, 8.0000e+00, 6.0000e+00,  ..., 2.0000e+00, 6.0000e+00,\n         1.0000e+00],\n        [2.5010e+01, 2.5009e+01, 2.4973e+01,  ..., 2.4935e+01, 2.4971e+01,\n         2.4974e+01],\n        [1.2149e+02, 1.2151e+02, 1.2153e+02,  ..., 1.2151e+02, 1.2150e+02,\n         1.2147e+02],\n        [1.0000e+00, 1.0000e+00, 1.0000e+00,  ..., 1.0000e+00, 1.0000e+00,\n         1.0000e+00]])\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "c90c3e5204a61773f24a3c90110826bc", "console": [], "id": "dGyc", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "fdaf77318730f67db39edb6f01acc161", "console": [], "id": "gjXN", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003Etorch.Size([6, 6])\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "822dff8a23f338e238896a50151b43d5", "console": [], "id": "Lyos", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "dea274997248f06934893ad554af2195", "console": [], "id": "ZPCK", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003Etorch.Size([6, 1])\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "e87eb88e7375d4292d1c420e1f213bdb", "console": [], "id": "Jvnp", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "f25d956f78d3343d9d543d833b4f9406", "console": [], "id": "lhDx", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "a36d6ffdd189139bf652b368490f83d8", "console": [], "id": "eFqC", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003Etorch.Size([5, 1])\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "92eb5ffee6ae2fec3ad71c777531578f", "console": [], "id": "zTee", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003Etensor([2069.7715])\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": null, "console": [], "id": "xysv", "outputs": []}, {"code_hash": "d9acdfd64fd5c663a7f1297738f46d0d", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "tensor(0.5223)\n", "type": "stream"}], "id": "WGep", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "62d104e1c23bc9a3bdd0ef2650363242", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "tensor(0.4744)\n", "type": "stream"}], "id": "MMvh", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": null, "console": [], "id": "KkLM", "outputs": []}], "metadata": {"marimo_version": "0.19.7"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    %23%20%2F%2F%2F%20script%0A%23%20requires-python%20%3D%20%22%3E%3D3.14%22%0A%23%20dependencies%20%3D%20%5B%0A%23%20%20%20%20%20%22marimo%3E%3D0.19.6%22%2C%0A%23%20%20%20%20%20%22matplotlib%3D%3D3.10.8%22%2C%0A%23%20%20%20%20%20%22pandas%3D%3D3.0.0%22%2C%0A%23%20%20%20%20%20%22torch%3D%3D2.9.1%22%2C%0A%23%20%5D%0A%23%20%2F%2F%2F%0A%0Aimport%20marimo%0A%0A__generated_with%20%3D%20%220.19.7%22%0Aapp%20%3D%20marimo.App(%0A%20%20%20%20width%3D%22columns%22%2C%0A%20%20%20%20app_title%3D%22Linear%20Regression%22%2C%0A%20%20%20%20css_file%3D%22style.css%22%2C%0A%20%20%20%20auto_download%3D%5B%22html%22%5D%2C%0A)%0A%0A%0A%40app.cell(column%3D0)%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20return%20(mo%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Linear%20regression%0A%0A%20%20%20%20We%20recall%20one%20of%20the%20most%20basic%20models%20in%20machine%20learning%3A%20linear%20regression.%20We%20apply%20it%20to%20the%20problem%20of%20predicting%20the%20price%20of%20a%20house.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Dataset%0A%0A%20%20%20%20We%20use%20the%20dataset%20available%20on%20%5BKaggle%5D(https%3A%2F%2Fwww.kaggle.com%2Fdatasets%2Fkirbysasuke%2Fhouse-price-prediction-simplified-for-regression).%20Its%20format%20is%20a%20CSV%20file.%20We%20load%20it%20as%20a%20%60DataFrame%60%20using%20the%20%60pandas%60%20library%20and%20we%20explore%20it.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20return%20(pd%2C)%0A%0A%0A%40app.cell%0Adef%20_(pd)%3A%0A%20%20%20%20from%20pathlib%20import%20Path%0A%0A%20%20%20%20BASE_DIR%20%3D%20Path(__file__).resolve().parent.parent%0A%0A%20%20%20%20data_path%20%3D%20BASE_DIR%20%2F%20'datasets'%20%2F%20'Real_Estate.csv'%0A%20%20%20%20data%20%3D%20pd.read_csv(data_path)%0A%20%20%20%20return%20(data%2C)%0A%0A%0A%40app.cell%0Adef%20_(data)%3A%0A%20%20%20%20data%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20We%20have%20a%20dataset%20with%20414%20observations%20and%207%20columns.%20We%20will%20do%20a%20simple%20linear%20regression%20using%20the%20following%20features%3A%0A%20%20%20%20-%20%60House%20age%60%20-%3E%20%24X_0%24%0A%20%20%20%20-%20%60Distance%20to%20the%20nearest%20MRT%20station%60%20-%3E%20%24X_1%24%0A%20%20%20%20-%20%60Number%20of%20convenience%20stores%60%20-%3E%20%24X_2%24%0A%20%20%20%20-%20%60Latitude%60%20-%3E%20%24X_3%24%0A%20%20%20%20-%20%60Longitude%60%20-%3E%20%24X_4%24%0A%0A%20%20%20%20trying%20to%20predict%20the%0A%20%20%20%20-%20%60House%20price%20of%20unit%20area%60%20-%3E%20%24Y%24%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(column%3D1%2C%20hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Recalling%20the%20linear%20regression%20model%0A%0A%20%20%20%20We%20want%20to%20predict%20the%20%60House%20price%20of%20unit%20area%60%20based%20on%20the%20other%20features%20with%20a%20linear%20model%2C%20_i.e._%2C%20a%20prediction%20based%20on%20the%20ansatz%0A%0A%20%20%20%20%24%24%0A%20%20%20%20Y%20%5Capprox%20w_0%20X_0%20%2B%20w_1%20X_1%20%2B%20w_2%20X_2%20%2B%20w_3%20X_3%20%2B%20w_4%20X_4%20%2B%20b.%0A%20%20%20%20%24%24%0A%0A%20%20%20%20The%20objective%20is%20to%20find%20%22good%22%20values%20for%20the%20weights%20%24w_0%2C%20w_1%2C%20w_2%2C%20w_3%2C%20w_4%24%20and%20the%20bias%20%24b%24%2C%20exploiting%20the%20available%20data.%0A%0A%20%20%20%20The%20linear%20regression%20model%20can%20be%20written%20compactly%20as%0A%0A%20%20%20%20%24%24%0A%20%20%20%20f(X%3Bw%2Cb)%20%3D%20Xw%20%2B%20b%2C%0A%20%20%20%20%24%24%0A%0A%20%20%20%20where%20%24X%20%3D%20(X_0%2C%20X_1%2C%20%5Cdots%2C%20X_%7BM-1%7D)%20%5Cin%20%5Cmathbb%7BR%7D%5E%7B1%20%5Ctimes%20M%7D%24%20is%20the%20random%20feature%20vector%2C%20%24w%20%5Cin%20%5Cmathbb%7BR%7D%5E%7BM%5Ctimes%201%7D%24%20is%20the%20weights%20vector%2C%20and%20%24b%20%5Cin%20%5Cmathbb%7BR%7D%24%20is%20the%20bias.%20The%20objective%20is%20to%20find%20the%20weights%20%24w%24%20and%20the%20bias%20%24b%24%20that%20minimize%20the%20mean%20squared%20error%20(MSE)%20between%20the%20predictions%20and%20the%20real%20target%2C%20_i.e._%2C%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cmin_%7B%5Csubstack%7Bw%20%5Cin%20%5Cmathbb%7BR%7D%5E%7BM%20%5Ctimes%201%7D%20%5C%5C%20%5C%20b%20%5Cin%20%5Cmathbb%7BR%7D%7D%7D%20L(w%2Cb%3B%5C%7B(x_i%2Cy_i)%5C%7D_%7Bi%3D0%2C%5Cdots%2CN-1%7D)%5C%2C%20%2C%20%5C%20%20%5Cquad%20%5Ctext%7Bwhere%20%7D%20L(w%2Cb%3B%5C%7B(x_i%2Cy_i)%5C%7D_%7Bi%3D0%2C%5Cdots%2CN-1%7D)%20%3D%20%5Cfrac%7B1%7D%7BN%7D%20%5Csum_%7Bi%3D0%7D%5E%7BN-1%7D%20(x_i%20w%20%2B%20b%20-%20y_i)%5E2.%0A%20%20%20%20%24%24%0A%0A%20%20%20%20The%20minimum%20can%20be%20found%20explicitly%20by%20solving%20the%20_normal%20equation_%0A%0A%20%20%20%20%24%24%0A%20%20%20%20A%20%5Cbegin%7Bpmatrix%7D%20w%20%5C%5C%20b%20%5Cend%7Bpmatrix%7D%20%3D%20c%20%2C%0A%20%20%20%20%24%24%0A%0A%20%20%20%20where%0A%0A%20%20%20%20%24%24%0A%20%20%20%20A%20%3D%20%5Cfrac%7B1%7D%7BN%7D%20%5Ctilde%20x%5E%5Ctop%20%5Ctilde%20x%20%5Cin%20%5Cmathbb%7BR%7D%5E%7B(M%2B1)%20%5Ctimes%20(M%2B1)%7D%20%2C%20%5Cquad%20c%20%3D%20%5Cfrac%7B1%7D%7BN%7D%20%5Ctilde%20x%5E%5Ctop%20y%20%2C%20%5Cquad%20%5Ctilde%20x%20%3D%20%5Cbegin%7Bpmatrix%7D%20x%20%26%201%20%5Cend%7Bpmatrix%7D%20%5Cin%20%5Cmathbb%7BR%7D%5E%7BN%20%5Ctimes%20(M%2B1)%7D%20.%0A%20%20%20%20%24%24%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0A%40app.cell(column%3D2)%0Adef%20_()%3A%0A%20%20%20%20import%20torch%0A%20%20%20%20return%20(torch%2C)%0A%0A%0A%40app.cell%0Adef%20_(data)%3A%0A%20%20%20%20features%20%3D%20%5B'House%20age'%2C%20'Distance%20to%20the%20nearest%20MRT%20station'%2C%20'Number%20of%20convenience%20stores'%2C%20'Latitude'%2C%20'Longitude'%5D%0A%20%20%20%20data%5Bfeatures%5D%20%0A%20%20%20%20return%20(features%2C)%0A%0A%0A%40app.cell%0Adef%20_(data)%3A%0A%20%20%20%20n_training_samples%20%3D%20int(0.8%20*%20len(data))%0A%20%20%20%20return%20(n_training_samples%2C)%0A%0A%0A%40app.cell%0Adef%20_(n_training_samples)%3A%0A%20%20%20%20n_training_samples%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(data%2C%20n_training_samples%2C%20torch)%3A%0A%20%20%20%20torch.manual_seed(42)%0A%20%20%20%20permuted_indices%20%3D%20torch.randperm(len(data))%0A%20%20%20%20training_indices%20%3D%20permuted_indices%5B%3An_training_samples%5D%0A%20%20%20%20test_indices%20%3D%20permuted_indices%5Bn_training_samples%3A%5D%0A%20%20%20%20return%20test_indices%2C%20training_indices%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20data%2C%0A%20%20%20%20features%2C%0A%20%20%20%20n_training_samples%2C%0A%20%20%20%20test_indices%2C%0A%20%20%20%20torch%2C%0A%20%20%20%20training_indices%2C%0A)%3A%0A%20%20%20%20x_train%20%3D%20torch.tensor(data%5Bfeatures%5D.iloc%5Btraining_indices%5D.values%2C%20dtype%3Dtorch.float32)%0A%20%20%20%20x_test%20%3D%20torch.tensor(data%5Bfeatures%5D.iloc%5Btest_indices%5D.values%2C%20dtype%3Dtorch.float32)%0A%20%20%20%20y_train%20%3D%20torch.tensor(data%5B'House%20price%20of%20unit%20area'%5D.iloc%5Btraining_indices%5D.values%2C%20dtype%3Dtorch.float32).view(n_training_samples%2C%201)%0A%20%20%20%20y_test%20%3D%20torch.tensor(data%5B'House%20price%20of%20unit%20area'%5D.iloc%5Btest_indices%5D.values%2C%20dtype%3Dtorch.float32).view(-1%2C%201)%0A%20%20%20%20return%20x_test%2C%20x_train%2C%20y_test%2C%20y_train%0A%0A%0A%40app.cell%0Adef%20_(x_train)%3A%0A%20%20%20%20x_train.shape%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(y_train)%3A%0A%20%20%20%20y_train.shape%0A%20%20%20%20return%0A%0A%0A%40app.cell(column%3D3)%0Adef%20_(n_training_samples%2C%20torch%2C%20x_train)%3A%0A%20%20%20%20x_tilde%20%3D%20torch.cat((x_train%2C%20torch.ones(n_training_samples%2C1))%2C%20dim%3D1)%0A%20%20%20%20return%20(x_tilde%2C)%0A%0A%0A%40app.cell%0Adef%20_(x_tilde)%3A%0A%20%20%20%20x_tilde.t()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(n_training_samples%2C%20x_tilde)%3A%0A%20%20%20%20A%20%3D%201%20%2F%20n_training_samples%20*%20x_tilde.t()%20%40%20x_tilde%0A%20%20%20%20return%20(A%2C)%0A%0A%0A%40app.cell%0Adef%20_(A)%3A%0A%20%20%20%20A.shape%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(n_training_samples%2C%20x_tilde%2C%20y_train)%3A%0A%20%20%20%20c%20%3D%201%20%2F%20n_training_samples%20*%20x_tilde.t()%20%40%20y_train%0A%20%20%20%20return%20(c%2C)%0A%0A%0A%40app.cell%0Adef%20_(c)%3A%0A%20%20%20%20c.shape%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(A%2C%20c%2C%20torch)%3A%0A%20%20%20%20solution%20%3D%20torch.linalg.solve(A%2C%20c)%0A%20%20%20%20return%20(solution%2C)%0A%0A%0A%40app.cell%0Adef%20_(solution)%3A%0A%20%20%20%20w%20%3D%20solution%5B%3A5%5D%0A%20%20%20%20b%20%3D%20solution%5B5%5D%0A%20%20%20%20return%20b%2C%20w%0A%0A%0A%40app.cell%0Adef%20_(w)%3A%0A%20%20%20%20w.shape%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(b)%3A%0A%20%20%20%20b%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0A%40app.cell(column%3D4)%0Adef%20_(b%2C%20w%2C%20x_train%2C%20y_train)%3A%0A%20%20%20%20R2_train%20%3D%201%20-%20(%20(%20y_train%20-%20(%20x_train%20%40%20w%20%2B%20b%20)%20)**2%20).sum()%20%2F%20(%20(%20y_train%20-%20y_train.mean()%20)**2%20).sum()%0A%20%20%20%20print(R2_train)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(b%2C%20w%2C%20x_test%2C%20y_test)%3A%0A%20%20%20%20R2_test%20%3D%201%20-%20(%20(%20y_test%20-%20(%20x_test%20%40%20w%20%2B%20b%20)%20)**2%20).sum()%20%2F%20(%20(%20y_test%20-%20y_test.mean()%20)**2%20).sum()%0A%20%20%20%20print(R2_test)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">a666364ea5aea954ddec1722ffc9ca42</marimo-code-hash>
</body>
</html>
